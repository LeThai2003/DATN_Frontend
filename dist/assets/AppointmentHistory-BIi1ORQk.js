import{a as E,c as o,cH as k,cd as C,cI as T,cJ as P,k as x,cg as c,cK as g,cL as w,j as e,av as M,aO as D,J as b,bq as O,P as R,cM as r,ak as S,aN as Y,h as z,Q as H,M as _,N as B}from"./index-LvNQFVEu.js";import{F as K,a as L}from"./FilterForm-Bc-RFcEQ.js";import{W as J}from"./WelcomeCard-sO44yQFy.js";const G=()=>{var m;const a=E(),l=o(k),n=o(C),d=o(T),s=o(P);x.useEffect(()=>{n!=null&&n.patientId&&(a(c.setFilterAppointment({...g,patientId:[n==null?void 0:n.patientId],statuses:["COMPLETE","CREATE","PAYMENT"]})),a(w()))},[n]);const[p,h]=x.useState(!1),j=t=>{a(_.setShowModal({type:B.APPOINTMENT_PATIENT,variant:"view",data:t}))},y=s==null?void 0:s.data,u=[{title:"Ngày khám",dataIndex:["shiftId","date"],key:"appointmentDate",render:t=>O(t).format("DD/MM/YYYY"),width:130},{title:"Bác sĩ khám",dataIndex:["shiftId","employeeDto","fullName"],key:"doctor",width:180},{title:"Phòng khám",dataIndex:["roomDto","name"],key:"specialization",width:150},{title:"Dịch vụ",dataIndex:["serviceId","name"],key:"service_name",width:100,ellipsis:!0},{title:"Giá dịch vụ",dataIndex:"price",key:"price",render:t=>`${t.toLocaleString()} ₫`,width:120},{title:"Trạng thái",dataIndex:"status",key:"status",width:120,render:t=>{const i=t==="COMPLETE"?"green":t==="CREATE"?"orange":"red",f=t==="COMPLETE"?"Hoàn thành":t==="CREATE"?"Chưa thanh toán":"Đã thanh toán";return e.jsx(S,{color:i,children:f})}},{title:"Hành động",key:"actions",width:130,align:"center",render:(t,i)=>(i==null?void 0:i.employee_id)==-1?null:e.jsx(Y,{title:e.jsx(e.Fragment,{children:"Xem chi tiết"}),children:e.jsx(z,{color:"primary",variant:"filled",icon:e.jsx(H,{}),onClick:()=>{j(i)},className:"",size:"small"})})}],A=[{key:"startDate",type:"date",placeholder:"Từ ngày"}],v=(t,i)=>{a(c.setFilterAppointment({...l,[t]:i})),a(r())},F=()=>{a(c.setFilterAppointment({...g})),a(r())},I=()=>{a(r())},N=t=>{a(c.setFilterAppointment({...l,pageNo:t-1})),a(r())};return e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"container min-h-screen relative",children:[d&&e.jsx("div",{className:"flex items-center justify-center z-20 absolute inset-0 bg-white/40",children:e.jsx(M,{})}),e.jsxs("div",{className:"pt-[86px]",children:[e.jsx(J,{name:n==null?void 0:n.fullName}),e.jsx("section",{className:"py-2 ",children:e.jsx(D,{title:"Lịch sử khám bệnh",children:(m=s==null?void 0:s.data)!=null&&m.length?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-3",children:[!p&&e.jsx(K,{onClick:()=>h(!0)}),p&&e.jsx(L,{fields:A,values:l,onChange:v,onReset:F,onApply:I,onClose:()=>h(!1)})]}),e.jsx(b,{dataSource:y,columns:u,rowKey:"appointmentId",pagination:!1,scroll:{x:"max-content",y:"400px"}}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(R,{current:(l==null?void 0:l.pageNo)+1||0,pageSize:10,onChange:t=>{N(t)},total:(s==null?void 0:s.totalPage)*10||1})})]}):e.jsx("div",{children:!d&&e.jsx("p",{children:"Không tìm thấy lịch sử khám bệnh."})})})})]})]})})};export{G as default};
